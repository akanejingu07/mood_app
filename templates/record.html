{% extends "base.html" %}

{% block content %}
<h2>{{ date }} ({{ weekday }})</h2>

<form method="POST" action="/record">
  <!-- カレンダーから日付が渡る -->
  <input type="hidden" name="record_date" value="{{ date }}">

  <label>天気:
    <input type="text" name="weather" value="{{ record.weather if record else '' }}">
  </label><br>

  <label>スコア:
    <input type="number" name="score" value="{{ record.score if record else '' }}" min="0" max="10">
  </label><br>

  <label>良かったこと1:
    <input type="text" name="good1" value="{{ record.good1 if record else '' }}">
  </label><br>

  <label>良かったこと2:
    <input type="text" name="good2" value="{{ record.good2 if record else '' }}">
  </label><br>

  <label>良かったこと3:
    <input type="text" name="good3" value="{{ record.good3 if record else '' }}">
  </label><br>

  <button type="submit">{{ '更新' if edit else '保存' }}</button>
</form>

{% endblock %}


<!-- 削除フォーム（完全に別） -->
{% if edit %}
<form method="post" action="/delete/{{ record.id }}"
      onsubmit="return confirm('この記録を削除しますか？\nこの操作は元に戻せません。');"
      style="margin-top: 16px;">
  <button type="submit" class="delete-btn">
    削除する
  </button>
</form>
{% endif %}

  
  </form>
  <p>
    <a href="/history">これまでの記録を見る</a>
  </p>
  
  <p>
    <a href="/logout">ログアウト</a>
  </p>
  </div>
  <script>
    const dateInput = document.getElementById("recordDate");
    const dateDisplay = document.getElementById("dateDisplay");
  
    const weekdays = ["日", "月", "火", "水", "木", "金", "土"];
  
    dateInput.addEventListener("change", () => {
      if (!dateInput.value) return;
  
      const d = new Date(dateInput.value);
      const weekday = weekdays[d.getDay()];
  
      dateDisplay.textContent = `${dateInput.value}（${weekday}）`;
    });
  </script>
  
</body>
</html>
